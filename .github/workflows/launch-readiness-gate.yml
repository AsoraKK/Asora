name: launch-readiness-gate

on:
  workflow_dispatch:

permissions:
  contents: read

jobs:
  readiness:
    name: Validate launch blocker evidence
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Validate observability alert routing config
        run: bash scripts/validate-alert-routing-config.sh

      - name: Validate store submission evidence checklist
        run: bash scripts/validate-store-submission-evidence.sh

      - name: Validate signing materials (Android + iOS)
        env:
          ANDROID_KEYSTORE_BASE64: ${{ secrets.ANDROID_KEYSTORE_BASE64 }}
          ANDROID_KEY_ALIAS: ${{ secrets.ANDROID_KEY_ALIAS }}
          ANDROID_KEYSTORE_PASSWORD: ${{ secrets.ANDROID_KEYSTORE_PASSWORD }}
          IOS_CERTIFICATE_P12_BASE64: ${{ secrets.IOS_CERTIFICATE_P12_BASE64 }}
          IOS_CERTIFICATE_PASSWORD: ${{ secrets.IOS_CERTIFICATE_PASSWORD }}
          IOS_PROVISIONING_PROFILE_BASE64: ${{ secrets.IOS_PROVISIONING_PROFILE_BASE64 }}
        run: bash scripts/validate-signing-material.sh
