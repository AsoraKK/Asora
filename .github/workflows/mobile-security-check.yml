name: Mobile Security Check

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]

jobs:
  check-pins-and-integrity:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Fail if SPKI placeholders remain
        run: |
          if grep -R "REPLACE_WITH_SPKI_PIN" -n lib/core/security/cert_pinning.dart; then
            echo "Found placeholder SPKI pins. Replace with real pins before merging." && exit 1
          fi
      - name: Dart format/lint (optional)
        run: echo "TODO: add dart analyze if desired"
